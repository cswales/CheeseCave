<!doctype html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-us" xml:lang="en-us">
<head>
	<link href="./main.css" rel="stylesheet" type="text/css"> 
	<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" /> 
	<script type="text/javascript" src="./jquery.min.js"></script>
	<script type="text/javascript">
	</script>
</head>
<body style="margin-left:20px;">
<div id="header">
<div width="30%" style="float:left;">
<h1>
Cheesecave
</h1>
</div>
<div style="min-width:20;float:left">&nbsp;&nbsp;</div>
<div >
<img src="./cheese.gif" width="120">
</div>
</div> <!-- end header -->
<div id='temp'>
<h2>Temperature</h2>
<table>
<tr>
<td>Current:</td> <td><span id='temp_current'></span></td>
</tr>
<tr>
<td>Setpoint:</td><td><span class='setpoint'></span></td>
</tr></table> 
<button>Change Setpoint</button>
</div>
<div id='humidity'>
<h2>Humidity</h2>
<table><tr>
<td>Current:</td><td> <span id='humidity_current'></span></td>
</tr><tr>
<td>Setpoint:</td><td><span id='humidity_setpoint'></span> </td>
</tr></table>
<button>Change Setpoint</button>
<div id='image'>
<h2>CheeseCam &nbsp;
<button type="button">Refresh Image</button></h2>
<div id='curImage'>
<img src="cheesecave/snapshot"/>
</div>
</div>

</body>
<script>
$(document).ready(function() {
	getHumidity();
	getTemperature();
	getHumiditySetpoint();
	getTemperatureSetpoint();
	// getCaveStats();
	// XXX need to set up image
});

function getCaveStats()
{
}

function getHumidity()
{
	$.ajax({
		type: 'GET',
		url:"/cheesecave/humidity",
		success: function(data, status, req) {
			if (data != "") {
				console.log("data is " + data);
				$("#humidity_current").html(data[0]);
				//var humidity = $.parseJSON(data);
			} else {
				console.log("No data");
			}
				
		},
		error: function(req,status,errorThrown) {
			printError("humidity get", req, status, errorThrown);
		}
	});
}

function getTemperature()
{
		$.ajax({
		type: 'GET',
		url:"/cheesecave/temp",
		success: function(data, status, req) {
			if (data != "") {
				$("#temp_current").html(data[0]);
				//var humidity = $.parseJSON(data);
			} else {
				console.log("No data");
			}
				
		},
		error: function(req,status,errorThrown) {
			printError("temp get", req, status, errorThrown);
		}
	});

}

function getHumiditySetpoint()
{
	$.ajax({
		type: 'GET',
		url:"/cheesecave/desired_humidity",
		success: function(data, status, req) {
			if (data != "") {
				$("#humidity_setpoint").html(data[0]);
				//var humidity = $.parseJSON(data);
			} else {
				console.log("No data");
			}
				
		},
		error: function(req,status,errorThrown) {
			printError("humidity get setpoint", req, status, errorThrown);
		}
	});
}

function getTemperatureSetpoint()
{
	$.ajax({
		type: 'GET',
		url:"/cheesecave/desired_temp",
		success: function(data, status, req) {
			if (data != "") {
				$("#temp .setpoint").html(data[0]);
				//var humidity = $.parseJSON(data);
			} else {
				console.log("No data");
			}
				
		},
		error: function(req,status,errorThrown) {
			printError("temp get setpoint", req, status, errorThrown);
		}
	});
}

function printError(origin, req, status, errorThrown)
{
	console.log(origin + " throws error "+ errorThrown);
}


</script>
</html>
